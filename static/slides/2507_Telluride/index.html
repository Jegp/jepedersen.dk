<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

	<title>Dynamical Systems for Control</title>

	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@5.2.1/dist/reset.css">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@5.2.1/dist/reveal.css">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@5.2.1/dist/theme/serif.css">

	<!-- Theme used for syntax highlighted code -->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@5.2.1/plugin/highlight/monokai.css">
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" rel="stylesheet">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/js/all.min.js"></script>

	<style>
		.reveal .slides section .fragment.fade-in-then-semi-out {
			opacity: 1;
			visibility: inherit;
		}
		.reveal .slides section .fragment.fade-in-then-semi-out.visible {
			opacity: 0.5;
			visibility: inherit;
		}
		.equation {
			font-size: 1.2em;
			margin: 20px 0;
		}
		.bio-example {
			background: #f0f8ff;
			padding: 20px;
			border-radius: 10px;
			margin: 20px 0;
		}
		.reveal blockquote {
			width: 100%;
		}
	</style>
</head>

<!-- TODO
Dynamics modelling
Basic intro (\dot{x} = f(x,u))
Modelling dynamics
Target dynamics: F10th? (get previous material from Tobi)
Autoregressive vs Multi-horizon prediction
With MLP (collecting data and predicting the model)
Predictions with SSMs
Learning dynamics
Quantization
Demo in control context (borrow from ETH F10th entry if possible?)


Pontryagin's principle 
-->

<body>
	<div class="reveal">
		<div class="slides">
			<!-- Title Slide -->
			<section>
				<section>
				<h1 style="font-size: 250%;">Dynamical Systems for Control</h1>
				<br/>
				<h5>Telluride Neuromorphic Cognition Workshop 2025</h5>
				<br/>
				<p>
					<strong>Jens Egholm Pedersen</strong>
					<br/>
					<span style="font-size: 80%;"><i class="fa fa-envelope"></i> jeped@kth.se</span>
					&nbsp;
					<span style="font-size: 80%;"><i class="fa-brands fa-mastodon"></i> jegp@mastodon.social </span>
					&nbsp;
					<span style="font-size: 80%;"><i class="fa fa-house"></i> <a href="https://jepedersen.dk">jepedersen.dk</a></span>
				</p>
				<div style="display: flex; justify-content: center; align-items: center; gap: 60px; font-size: 70%;">
					<img src="../2304_NICE/kth.png" 
						 alt="KTH Logo" 
						 style="height: 70px;"> KTH Royal Institute of Technology
				</div>
				<aside class="notes">
					Welcome to this tutorial on dynamical systems for control. Today we'll journey from biological systems 
					to modern computational approaches, building mathematical tools along the way.
				</aside></section>

				<section>
					<h1>Caveat emptor</h1>
					<ul>
						<li class="fragment">Huge topic to a broad audience</li>
						<li class="fragment">Focus on mathematical abstractions</li>
						<li class="fragment">Biological motivation <span class="fragment">- neural focus</span></li>
						<li class="fragment">Emphasis on practice and code</li>
						<li class="fragment">Slides at jepedersen.dk <span class="fragment">- but take notes!</span></li>
						</li>
					</ul>
				</section>
			</section>

			<!-- Section 1: Biological Motivation -->
			<section>
				<section>
					<h2>1. Biological motivation</h2>
					<h3>Dynamical systems in nature</h3>
				</section>

				<section>
					<h3>Central Pattern Generators (CPGs)</h3>
					<div style="display: flex; gap: 30px; align-items: center;">
						<div style="flex: 1 c;">
							<div class="bio-example">
								<p><strong>Locomotion:</strong> Rhythmic leg movements in walking</p>
								<p><strong>Breathing:</strong> Automatic respiratory rhythm</p>
								<p><strong>Swimming:</strong> Coordinated body undulation</p>
							</div>
							<p class="fragment">Key insight: <em>Autonomous rhythm generation without external timing</em></p>
						</div>
						<div style="flex: 0 0 200px;" class="fragment">
							<img src="https://mediacdn.nhbs.com/jackets/jackets_resizer_xlarge/23/239893.jpg" 
								 alt="Lessons from the Lobster book cover" 
								 style="width: 100%; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.2);">
						</div>
					</div>
					<aside class="notes">
						CPGs are neural circuits that produce rhythmic outputs without rhythmic inputs. 
						Eve Marder's "Lessons from the Lobster" details her groundbreaking work on the stomatogastric ganglion,
						revealing fundamental principles of neural circuit flexibility and robustness in biological control systems.
					</aside>
				</section>

				<section>
					<h3>Neural oscillators</h3>
					<p>Individual neurons can act as oscillators:</p>
					<ul>
						<li class="fragment">Synaptic feedback loops</li>
						<li class="fragment">Network interactions</li>
					</ul>
					<p class="fragment"><strong>Coupled oscillator networks</strong> → Complex spatiotemporal patterns</p>
					<div style="flex: 0 0 200px;" class="fragment">
							<img src="https://github.com/akandykeller/NeuralWaveMachines/raw/master/figures/rotating_mnist_full.gif" alt="Neural wave machines gif" 
								 style="width: 60%; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.2);">
						<small>Andy Keller & Max Welling, Neural Wave Machines, 2023</small>
						</div>
				</section>

				<section>
					<h3>The Mathematical Challenge</h3>
					<p>How do we understand and control these systems?</p>
					<div class="fragment">
						<p>We need mathematical tools to:</p>
						<ul>
							<li>Model the dynamics</li>
							<li>Predict behavior</li>
							<li>Design control strategies</li>
							<li>Establish guarantees</li>
						</ul>
					</div>
				</section>

				<section>
					<blockquote>
						An organism [...] is observed in different states.
						This <i>observed system</i> is the target of the modeling activity.
						Its states cannot really be described by only a few observable parameters, but we pretend they can
						<br/>[...]<br/>
						The relationship between the actual states of the real organism and the points of the geometric model is a fiction 
					</blockquote>
					<p><strong>— Abraham and Shaw 1991</strong></p>
				</section>
			</section>

			<!-- Section 2: State Space Foundations -->
			<section>
				<section>
					<h2>2. State Space Foundations</h2>
					<h3>From Biology to Mathematics</h3>
				</section>

				<section>
					<h3>State Space Representation</h3>
						$$\dot{x} = f(x, u)$$
						$$y = h(x, u)$$
					<p>Where:</p>
					<ul>
						<li><strong>x</strong>: state vector (internal variables)</li>
						<li><strong>u</strong>: input/control vector</li>
						<li><strong>y</strong>: output/observation vector</li>
					</ul>
					<aside class="notes">
						This is the fundamental mathematical abstraction. The state captures all the information 
						needed to predict future behavior given current inputs.
					</aside>
				</section>

				<section>
					<h3>Constant System (No State)</h3>
					<p>Simplest case: no internal dynamics, just input-output mapping</p>
					$$y = u$$
					<div id="constant-sim-container" style="height: 300px; margin: 20px 0;"></div>
				</section>

				<section>
					<h3>Simple 1-State System</h3>
					<p>One-dimensional exponential decay with input
						$$\dot{x} = -\lambda x + u$$
					</p>
					<div id="decay-sim-container" style="height: 300px; margin: 20px 0;"></div>
					<p><small>This system has memory - its state x evolves over time based on decay rate λ and input u.</small></p>
				</section>

				<section>
					<h3>Example: Motor Control</h3>
					<div class="bio-example">
						<p><strong>State (x):</strong> Joint angles, velocities, muscle activations</p>
						<p><strong>Input (u):</strong> Motor commands from brain</p>
						<p><strong>Output (y):</strong> Limb position, sensory feedback</p>
					</div>
					<p class="fragment">The state space captures the full "configuration" of the system</p>
				</section>

				<section>
					<h3>Linear Time-Invariant (LTI) Systems</h3>
					<p>A special class of systems with nice properties</p>
					$$y(t) = (x \star h)(t)$$
					<p>Where $x$ is input, $t$ is time, $h$ is the <i>impulse response</i> </p>
					<ul class="fragment">
						<li><strong>Linear:</strong> Superposition principle applies</li>
						<li><strong>Time-invariant:</strong> System parameters don't change</li>
						<li><strong>Analytical solutions:</strong> The convolution integral</li>
					</ul>
				</section>

				<section>
					<h3>Observability</h3>
					<p><em>Can we determine the internal state from observations?</em> <small>(in LTI systems)</small></p>
					<div style="display: flex; gap: 30px; align-items: center; flex-direction: row;">
					<div class="equation fragment" style="flex: 1;">
						$$\begin{align*}
						\dot{x} &= Ax + Bu \\
						\mathcal{O} &= \begin{bmatrix} C \\ CA \\ CA^2 \\ \vdots \end{bmatrix}
						\end{align*}$$
					</div>
					<div class="fragment" style="flex: 1;">System is observable if rank($\mathcal{O}$) = n
						<br/>
						<small>($n$ columns are linearly independent)</small>
					<div class="fragment bio-example">
						What can we infer about neural state from recordings?
					</div>
				</div>
					</div>
				</section>

				<section>
					<h3>Controllability</h3>
					<p><em>Can we steer the system to any desired state?</em></p>
					<div class="equation fragment">
						$$\begin{align*}
						\dot{x} &= Ax + Bu \\
						\mathcal{C} &= \begin{bmatrix} B & AB & A^2B & \cdots & A^{n-1}B \end{bmatrix}
						\end{align*}$$
					</div>
					<p class="fragment">System is controllable if rank($\mathcal{C}$) = n<br/>
					<small>(Dual to observability)</small>
					</p>
					<div class="fragment bio-example">
						Can we influence dynamics through stimulation?
					</div>
				</section>

				<section>
					<h3>Sensorimotor integration</h3>
					<p>Observability + controllability = closed-loop control</p>
					<div class="equation fragment">
						$$u = -K(x - x_{\text{desired}}) + u_{\text{feedforward}}$$
					</div>
					<div class="fragment">
						<p>Where:</p>
						<ul>
							<li><strong>K</strong>: feedback gain matrix (strength of correction)</li>
							<li><strong>x</strong>: current state (observed through sensors)</li>
							<li><strong>x<sub>desired</sub></strong>: target state (motor goal)</li>
							<li><strong>u<sub>feedforward</sub></strong>: anticipated control (motor program)</li>
						</ul>
					</div>
					<p class="fragment">This is the foundation of biological motor control!</p>
				</section>

				<section>
					<h3>Demonstration: leaky integrator</h3>
					$$\tau \dot{x} = -x + I(t)$$
					<div id="sim-container" style="height: 300px; margin: 0 0 20px;"></div>
					<aside class="notes">
						The leaky integrator is fundamental in neuroscience - it models how neurons integrate synaptic inputs.
						τ controls integration time scale, I is synaptic input, η is noise.
						When τ is large: slow integration, good memory. When τ is small: fast response, poor memory.
						This demonstrates the fundamental trade-off between integration and responsiveness.
					</aside>
				</section>

				<section>
					<h3>Example: Leaky integrator</h3>
					<p>Let's analyze observability and controllability</p>
						$$\begin{align*}
						\dot{x} &= -\frac{1}{\tau}x + \frac{1}{\tau}u \quad \text{(dynamics)} \\
						y &= x \quad \text{(output)}
						\end{align*}$$
					<div class="fragment">
						<p><strong>State-space matrices:</strong></p>
						<ul>
							<li>$A = -\frac{1}{\tau}$ (how state evolves)</li>
							<li>$B = \frac{1}{\tau}$ (how input affects state)</li>
							<li>$C = 1$ (how we observe the state: $y = 1 \cdot x$)</li>
						</ul>
					</div>
				</section>
				<section>
					<h3>Example: Leaky integrator</h3>
					<p>Let's analyze observability and controllability</p>
						$$\begin{align*}
						\dot{x} &= -\frac{1}{\tau}x + \frac{1}{\tau}u \quad \text{(dynamics)} \\
						y &= x \quad \text{(output)}
						\end{align*}$$
					<div class="fragment">
						<ul>
							<li><strong>Observability:</strong> $\mathcal{O} = [C] = [1]$ → rank = 1 ✓</li>
							<li><strong>Controllability:</strong> $\mathcal{C} = [B] = [\frac{1}{\tau}]$ → rank = 1 ✓</li>
						</ul>
					</div>
					<div class="fragment bio-example">
						<strong>Interpretation:</strong> We can observe the neuron's state and control it with input current
					</div>
				</section>
			</section>

			<!-- Section 3: Optimization & Stability -->
			<section>
				<section>
					<h2>3. Optimization & stability</h2>
					<h3>Energy landscapes and optimality</h3>
				</section>

				<section>
					<h3>Energy-based optimization</h3>
					<p>Many physical systems minimize energy functions:</p>
					<div class="equation">
						$$V(x) = \text{potential energy function}$$
						$$\dot{x} = -\nabla V(x) + \text{noise}$$
					</div>
					<div class="fragment bio-example">
						<strong>Examples:</strong> Neural network dynamics, protein folding, gradient-based learning, ...
					</div>
					<aside class="notes">
						This is a powerful abstraction. Many biological systems can be viewed as minimizing some energy landscape.
						For example, neural networks can be seen as optimizing synaptic weights to minimize error.
						Lagrange dynamics is a common framework for modeling these systems.
					</aside>
				</section>

				<section>
					<h3>Lyapunov Stability</h3>
					<p>How do we prove a system is stable?</p>
					<div class="equation fragment">
						$$V(x) > 0 \text{ for } x \neq 0$$
						$$\dot{V}(x) \leq 0$$
					</div>
					<p class="fragment">If such a function V exists → system is stable</p>
					<div class="fragment bio-example">
						<strong>Examples:</strong> Homeostasis, robust neural computation, safety in control systems
					</div>
				</section>

				<section>
					<h3>Pontryagin's Maximum Principle</h3>
					<p>Optimal control: minimize cost subject to dynamics</p>
					<div class="equation">
						$$\min \int_0^T L(x, u, t) dt + \phi(x(T))$$
					</div>
					<div class="equation fragment">
						$$H = L(x, u, t) + \lambda^T f(x, u, t)$$
						$$\frac{\partial H}{\partial u} = 0$$
					</div>
					<p class="fragment">Gives us necessary conditions for optimal control</p>
				</section>

				<section>
					<h3>Combining Stability & Optimality</h3>
					<p>Pontryagin + Lyapunov → Robust optimal control</p>
					<div class="fragment">
						<p>Design controllers that are:</p>
						<ul>
							<li>Optimal (minimize cost)</li>
							<li>Stable (bounded behavior)</li>
							<li>Robust (handle uncertainty)</li>
						</ul>
					</div>
					<div class="fragment bio-example">
						<strong>Biological example:</strong> Motor control with energy constraints and stability requirements
					</div>
				</section>
			</section>

			<!-- Section 4: Phase Space and Attractors -->
			<section>
				<section>
					<h2>4. Phase space and attractors</h2>
					<h3>Visualizing System Behavior</h3>
				</section>

				<section>
					<h3>Phase Space</h3>
					<p>The space of all possible states of a dynamical system</p>
					<div class="equation">
						$$\text{Phase space} = \{(x_1, x_2, \ldots, x_n) : x_i \in \mathbb{R}\}$$
					</div>
					<ul class="fragment">
						<li><strong>Each point</strong> represents a complete system state</li>
						<li><strong>Trajectories</strong> show how states evolve over time</li>
						<li><strong>Dimension</strong> equals number of state variables</li>
					</ul>
					<div class="fragment bio-example">
						<strong>Example:</strong> Neuron membrane potential and its derivative form 2D phase space
					</div>
				</section>

				<section>
					<h3>Phase Portraits</h3>
					<p>Visual representation of system dynamics in phase space</p>
					<ul class="fragment">
						<li><strong>Vector field:</strong> Shows direction of flow at each point</li>
						<li><strong>Trajectories:</strong> Solution curves starting from different initial conditions</li>
						<li><strong>Nullclines:</strong> Where $\dot{x}_i = 0$</li>
					</ul>
					<div class="fragment bio-example">
						<strong>Insight:</strong> Phase portraits reveal global behavior patterns
					</div>
				</section>

				<section>
					<h3>Attractors</h3>
					<p>Regions in phase space that "attract" nearby trajectories</p>
					<ul>
						<li class="fragment"><strong>Fixed points:</strong> $\dot{x} = 0$ (equilibrium states)</li>
						<li class="fragment"><strong>Limit cycles:</strong> Closed periodic orbits</li>
						<li class="fragment"><strong>Strange attractors:</strong> Chaotic, fractal structures</li>
					</ul>
					<div class="fragment bio-example">
						<strong>Biology:</strong> Fixed points → memory states, Limit cycles → rhythmic behaviors
					</div>
				</section>

				<section>
					<h3>Basins of Attraction</h3>
					<p>Set of initial conditions that lead to the same attractor</p>
					<div class="equation fragment">
						$$B(A) = \{x_0 : \lim_{t \to \infty} x(t, x_0) \in A\}$$
					</div>
					<ul class="fragment">
						<li><strong>Separatrices:</strong> Boundaries between basins</li>
						<li><strong>Multistability:</strong> Multiple attractors coexist</li>
					</ul>
					<div class="fragment bio-example">
						<strong>Neural computation:</strong> Different basins → different memories or decisions
					</div>
				</section>

				<section>
					<h3>Example: Pendulum Dynamics</h3>
					<p>Classic example showing rich phase space structure</p>
					<div class="equation">
						$$\ddot{\theta} + \frac{g}{l}\sin\theta = 0$$
						$$\text{or } \begin{cases} \dot{\theta} = \omega \\ \dot{\omega} = -\frac{g}{l}\sin\theta \end{cases}$$
					</div>
					<div class="fragment">
						<ul>
							<li><strong>Fixed points:</strong> $(\theta, \omega) = (0, 0), (\pi, 0)$</li>
							<li><strong>Separatrices:</strong> Divide oscillation from rotation</li>
							<li><strong>Conservation:</strong> Energy is conserved (Hamiltonian system)</li>
						</ul>
					</div>
					<div class="fragment bio-example">
						<strong>Bio-analogy:</strong> Neural oscillators, motor pattern generators
					</div>
				</section>

				<section>
					<h3>Attractor Networks in Biology</h3>
					<p>How biological systems use attractors for computation</p>
					<ul>
						<li class="fragment"><strong>Hopfield networks:</strong> Fixed-point attractors for memory</li>
						<li class="fragment"><strong>Central pattern generators:</strong> Limit cycles for rhythmic motion</li>
						<li class="fragment"><strong>Decision circuits:</strong> Winner-take-all dynamics</li>
						<li class="fragment"><strong>Neural avalanches:</strong> Critical dynamics near bifurcations</li>
					</ul>
					<div class="fragment bio-example">
						<strong>Key insight:</strong> Attractors provide robust computation despite noise
					</div>
				</section>
			</section>

			<!-- Section 5: Neural Network Dynamics -->
			<section>
				<section>
					<h2>5. Neural Network Dynamics</h2>
					<h3>From Biology to Modern AI</h3>
				</section>

				<section>
					<h3>Continuous-Time RNNs</h3>
					<div class="equation">
						$$\tau \dot{h} = -h + W \sigma(h) + W_{\text{in}} u$$
						$$y = W_{\text{out}} h$$
					</div>
					<p>Key insight: <em>Neural dynamics as dynamical systems</em></p>
					<div class="fragment bio-example">
						<strong>Biological correspondence:</strong> τ = membrane time constant, σ = activation function
					</div>
				</section>

				<section>
					<h3>Reservoir Computing</h3>
					<p>Fixed random recurrent network + trainable readout</p>
					<div class="equation">
						$$\dot{x} = -x + W_{\text{res}} \tanh(x) + W_{\text{in}} u$$
						$$y = W_{\text{out}} x$$
					</div>
					<p class="fragment">Only train $W_{\text{out}}$ → computationally efficient</p>
					<div class="fragment bio-example">
						<strong>Biological inspiration:</strong> Cortical microcircuits as computational reservoirs
					</div>
				</section>

				<section>
					<h3>Modern State Space Models</h3>
					<p>Recent breakthrough: Structured State Space Models (S4, Mamba)</p>
					<div class="equation">
						$$\dot{x} = Ax + Bu$$
						$$y = Cx + Du$$
					</div>
					<p class="fragment">Key innovations:</p>
					<ul class="fragment">
						<li>Structured matrices (A) for efficiency</li>
						<li>Selective mechanisms (attention-like)</li>
						<li>Long-range dependencies</li>
					</ul>
				</section>

				<section>
					<h3>SSM vs Traditional RNNs</h3>
					<table class="fragment">
						<tr>
							<th></th>
							<th>RNNs</th>
							<th>SSMs</th>
						</tr>
						<tr>
							<td>Training</td>
							<td>Sequential</td>
							<td>Parallel</td>
						</tr>
						<tr>
							<td>Long-range</td>
							<td>Limited</td>
							<td>Excellent</td>
						</tr>
						<tr>
							<td>Efficiency</td>
							<td>Moderate</td>
							<td>High</td>
						</tr>
					</table>
					<p class="fragment">SSMs bring dynamical systems thinking to modern AI</p>
				</section>

				<section>
					<h3>Bridging Biology and AI</h3>
					<p>Common principles:</p>
					<ul>
						<li class="fragment">State-based computation</li>
						<li class="fragment">Temporal dynamics</li>
						<li class="fragment">Hierarchical processing</li>
						<li class="fragment">Adaptive behavior</li>
					</ul>
					<div class="fragment bio-example">
						<strong>Future direction:</strong> Neuromorphic hardware implementing SSM-like dynamics
					</div>
				</section>

				<section>
					<h3>Controllability in Neural Networks</h3>
					<p>Can we control neural network dynamics?</p>
					<div class="fragment">
						<p>Applications:</p>
						<ul>
							<li>Neural stimulation protocols</li>
							<li>Adversarial robustness</li>
							<li>Network architecture design</li>
						</ul>
					</div>
					<p class="fragment">Controllability analysis guides intervention strategies</p>
				</section>
			</section>

			<!-- Section 6: Integration & Applications -->
			<section>
				<section>
					<h2>6. Integration & Applications</h2>
					<h3>Bringing It All Together</h3>
				</section>

				<section>
					<h3>Neuromorphic Control Systems</h3>
					<p>Combining biological principles with engineering:</p>
					<ul>
						<li class="fragment">Event-driven computation</li>
						<li class="fragment">Distributed processing</li>
						<li class="fragment">Adaptive learning</li>
						<li class="fragment">Energy efficiency</li>
					</ul>
					<div class="fragment bio-example">
						<strong>Example:</strong> Neuromorphic motor control using spiking neural networks
					</div>
				</section>

				<section>
					<h3>Design Principles</h3>
					<div class="equation">
						\begin{align}
						\text{Observability} &\rightarrow \text{State estimation} \\
						\text{Controllability} &\rightarrow \text{Control design} \\
						\text{Stability} &\rightarrow \text{Robust operation} \\
						\text{Optimality} &\rightarrow \text{Efficient control}
						\end{align}
					</div>
				</section>

				<section>
					<h3>Future Directions</h3>
					<ul>
						<li class="fragment"><strong>Hybrid systems:</strong> Continuous dynamics + discrete events</li>
						<li class="fragment"><strong>Distributed control:</strong> Multi-agent coordination</li>
						<li class="fragment"><strong>Learning dynamics:</strong> Adaptive control laws</li>
						<li class="fragment"><strong>Quantum control:</strong> Next frontier in control theory</li>
					</ul>
				</section>

				<section>
					<h3>Modern SSMs Meet Biology</h3>
					<p>Exciting convergence:</p>
					<ul>
						<li class="fragment">SSMs capture long-range dependencies</li>
						<li class="fragment">Biological systems show similar properties</li>
						<li class="fragment">Neuromorphic hardware can implement both</li>
					</ul>
					<div class="fragment bio-example">
						<strong>Research opportunity:</strong> Bio-inspired SSM architectures for neuromorphic control
					</div>
				</section>

				<section>
					<h2>Summary</h2>
					<p>We've connected:</p>
					<ul>
						<li class="fragment">Biological rhythms → Mathematical dynamics</li>
						<li class="fragment">State space theory → Control design</li>
						<li class="fragment">Stability analysis → Robust systems</li>
						<li class="fragment">Neural networks → Modern AI</li>
						<li class="fragment">Theory → Neuromorphic applications</li>
					</ul>
					<p class="fragment"><strong>The future of control is neuromorphic!</strong></p>
				</section>

				<section style="font-size:50%;">
					<h2>Resources</h2>
					<div style="text-align: left; margin: 40px auto; max-width: 800px;">
						<div style="margin: 30px 0; padding: 20px; background: #f8f9fa; border-radius: 10px; border-left: 4px solid #007bff;">
							<h4 style="margin-top: 0; color: #007bff;">📚 Textbooks & Theory</h4>
							<p><a href="http://www.aerialpress.com/DYN/" target="_blank" style="color: #007bff; text-decoration: none; font-weight: bold;">
								Dynamics: The Geometry of Behavior (Abraham & Shaw)
							</a></p>
							<p style="font-size: 0.9em; color: #666; margin: 5px 0;">Classic text on dynamical systems theory and geometric approaches</p>
						</div>
						
						<div style="margin: 30px 0; padding: 20px; background: #f8f9fa; border-radius: 10px; border-left: 4px solid #28a745;">
							<h4 style="margin-top: 0; color: #28a745;">🧠 Neural Dynamics</h4>
							<p><a href="https://neuronaldynamics.epfl.ch/" target="_blank" style="color: #28a745; text-decoration: none; font-weight: bold;">
								Neuronal Dynamics (Gerstner, Kistler, Naud & Paninski)
							</a></p>
							<p style="font-size: 0.9em; color: #666; margin: 5px 0;">Comprehensive online textbook on spiking neuron models and neural coding</p>
						</div>
						
						<div style="margin: 30px 0; padding: 20px; background: #f8f9fa; border-radius: 10px; border-left: 4px solid #dc3545;">
							<h4 style="margin-top: 0; color: #dc3545;">⚙️ Simulation Tools</h4>
							<p><a href="https://www.nengo.ai/" target="_blank" style="color: #dc3545; text-decoration: none; font-weight: bold;">
								Nengo: Neural Engineering Framework
							</a></p>
							<p style="font-size: 0.9em; color: #666; margin: 5px 0;">Python library for building large-scale neural models and neuromorphic applications</p>
						</div>
					</div>
				</section>

				<section>
					<h2>Questions?</h2>
					<p>Thank you for your attention!</p>
					<br>
					<p><small>Telluride Neuromorphic Cognition Workshop 2025</small></p>
				</section>
			</section>
		</div>
	</div>

	<script src="https://cdn.jsdelivr.net/npm/reveal.js@5.2.1/dist/reveal.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/reveal.js@5.2.1/plugin/notes/notes.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/reveal.js@5.2.1/plugin/markdown/markdown.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/reveal.js@5.2.1/plugin/highlight/highlight.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/reveal.js@5.2.1/plugin/math/math.js"></script>
	
	<!-- Plotly for interactive simulations -->
	<script src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>
	<!-- Dynamical Systems Simulator -->
	<script src="dynamical_systems.js"></script>

	<script>
		// More info about initialization & config:
		// - https://revealjs.com/initialization/
		// - https://revealjs.com/config/
		Reveal.initialize({
			hash: true,
			transition: 'slide',
			transitionSpeed: 'fast',
			backgroundTransition: 'fade',
			
			// Learn about plugins: https://revealjs.com/plugins/
			plugins: [RevealMarkdown, RevealHighlight, RevealNotes, RevealMath.KaTeX]
		});

		// Initialize dynamical systems simulator when reveal.js is ready
		Reveal.addEventListener('ready', function() {
			// Check if sim container exists and initialize simulator
			const simContainer = document.getElementById('sim-container');
			if (simContainer) {
				window.dynamicalSimulator = createDynamicalSystemsSimulator('sim-container', {
					height: 400,
					maxPoints: 200,
					system: {
						name: 'Leaky Integrator',
						equation: 'τẋ = -x + I',
						parameters: [
							{ id: 'tau', label: 'Time Constant (τ)', min: 0.5, max: 5, step: 0.1, value: 1.5 },
							{ id: 'input', label: 'Input Current (I)', min: -2, max: 2, step: 0.1, value: 0.5 },
							],
						initialState: { x: 0, y: 0, z: 0, t: 0 },
						simulate: (params, state, dt) => {
							const [tau, input] = params;
							const dx = (-state.x + input) / tau;
							return {
								x: state.x + dt * dx,
								y: dx,
								z: 0,
								t: state.t + dt
							};
						},
						plotType: 'timeseries',
						plotConfig: {
							title: 'Leaky Integrator: τẋ = -x + I',
							xaxis: { title: 'Time', range: [0, 25] },
							yaxis: { title: 'x(t)', range: [-3, 3] }
						}
					}
				});
			}

			// Initialize constant system simulator
			const constantSimContainer = document.getElementById('constant-sim-container');
			if (constantSimContainer) {
				window.constantSimulator = createDynamicalSystemsSimulator('constant-sim-container', {
					height: 300,
					maxPoints: 100,
					system: {
						name: 'Constant System',
						equation: 'y = u',
						parameters: [
							{ id: 'input', label: 'Input (u)', min: -2, max: 2, step: 0.1, value: 1 }
						],
						initialState: { x: 0, y: 0, z: 0, t: 0 },
						simulate: (params, state, dt) => {
							const [u] = params;
							return {
								x: u,
								y: u,
								z: 0,
								t: state.t + dt
							};
						},
						plotType: 'timeseries',
						plotConfig: {
							title: 'Constant System: y = u',
							xaxis: { title: 'Time', range: [0, 10] },
							yaxis: { title: 'y(t)', range: [-2.5, 2.5] }
						}
					}
				});
			}

			// Initialize decay system simulator
			const decaySimContainer = document.getElementById('decay-sim-container');
			if (decaySimContainer) {
				window.decaySimulator = createDynamicalSystemsSimulator('decay-sim-container', {
					height: 300,
					maxPoints: 100,
					system: {
						name: 'Exponential Decay',
						equation: 'ẋ = -λx + u',
						parameters: [
							{ id: 'lambda', label: 'Decay Rate (λ)', min: 0.1, max: 2, step: 0.1, value: 0.5 },
							{ id: 'input', label: 'Input (u)', min: -1, max: 1, step: 0.1, value: 0 }
						],
						initialState: { x: 1, y: 0, z: 0, t: 0 },
						simulate: (params, state, dt) => {
							const [lambda, u] = params;
							const dx = -lambda * state.x + u;
							return {
								x: state.x + dt * dx,
								y: dx,
								z: 0,
								t: state.t + dt
							};
						},
						plotType: 'timeseries',
						plotConfig: {
							title: 'Exponential Decay: ẋ = -λx + u',
							xaxis: { title: 'Time', range: [0, 20] },
							yaxis: { title: 'x(t)', range: [-8, 8] }
						}
					}
				});
			}
		});

		// Handle slide changes to manage simulator
		Reveal.addEventListener('slidechanged', function(event) {
			const currentSlide = event.currentSlide;
			const hasSimulator = currentSlide.querySelector('#sim-container');
			const hasConstantSimulator = currentSlide.querySelector('#constant-sim-container');
			const hasDecaySimulator = currentSlide.querySelector('#decay-sim-container');
			
			// Manage original simulator
			if (window.dynamicalSimulator) {
				if (hasSimulator) {
					window.dynamicalSimulator.startAnimation();
				} else {
					window.dynamicalSimulator.stopAnimation();
				}
			}
			
			// Manage constant system simulator
			if (window.constantSimulator) {
				if (hasConstantSimulator) {
					window.constantSimulator.startAnimation();
				} else {
					window.constantSimulator.stopAnimation();
				}
			}
			
			// Manage decay system simulator
			if (window.decaySimulator) {
				if (hasDecaySimulator) {
					window.decaySimulator.startAnimation();
				} else {
					window.decaySimulator.stopAnimation();
				}
			}
		});
	</script>

</body>
</html>